<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="theme-color" content="#0a0f1e">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<title>PHC Pediatric Dose</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;background:#0a0f1e;color:#e8f0ff;min-height:100vh}
header{position:sticky;top:0;z-index:100;background:rgba(20,29,53,.95);backdrop-filter:blur(20px);border-bottom:1px solid rgba(77,163,255,.15);padding:16px 20px}
h1{font-size:20px;font-weight:900;background:linear-gradient(135deg,#4da3ff,#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.sub{margin-top:6px;font-size:12px;color:#6b7a9a}
.wrap{padding:16px 20px 100px;max-width:800px;margin:0 auto}
.card{background:rgba(20,29,53,.7);border:1px solid #213055;border-radius:16px;padding:20px;margin:16px 0}
.warn-box{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);border-radius:12px;padding:14px;margin:12px 0;font-size:13px;display:flex;gap:12px}
.alert-box{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);border-radius:12px;padding:14px;margin:12px 0;font-size:13px;display:flex;gap:12px}
.info-box{background:rgba(77,163,255,.1);border:1px solid rgba(77,163,255,.3);border-radius:12px;padding:14px;margin:12px 0;font-size:13px}
.growth-box{background:rgba(22,163,74,.1);border:1px solid rgba(22,163,74,.3);border-radius:12px;padding:14px;margin-top:12px;font-size:13px;line-height:1.6}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.fld{margin-bottom:12px}
.fld label{display:block;font-size:11px;font-weight:700;color:#6b7a9a;margin-bottom:8px;text-transform:uppercase}
.fld input,.fld select{width:100%;padding:12px 16px;border-radius:12px;border:1.5px solid #213055;background:#0f1629;color:#e8f0ff;font-size:15px;font-weight:600}
.fld input:focus,.fld select:focus{outline:none;border-color:#4da3ff}
.fld select.male{border-color:#4da3ff;box-shadow:0 0 0 3px rgba(77,163,255,.2)}
.fld select.female{border-color:#ff69b4;box-shadow:0 0 0 3px rgba(255,105,180,.2)}
.sum{background:linear-gradient(135deg,rgba(77,163,255,.15),rgba(168,85,247,.1));border:1.5px solid rgba(77,163,255,.3);border-radius:12px;padding:14px 18px;font-size:14px;font-weight:700;margin-top:16px}
.sum.male{background:linear-gradient(135deg,rgba(77,163,255,.2),rgba(96,165,250,.1));border-color:rgba(77,163,255,.4)}
.sum.female{background:linear-gradient(135deg,rgba(255,105,180,.2),rgba(251,113,219,.1));border-color:rgba(255,105,180,.4)}
.search{width:100%;padding:14px 20px;border-radius:14px;border:1.5px solid #213055;background:#0f1629;color:#e8f0ff;font-size:15px;margin-bottom:16px}
.search:focus{outline:none;border-color:#4da3ff}
.btn{background:rgba(77,163,255,.2);border:1.5px solid rgba(77,163,255,.4);color:#e3f2ff;padding:10px 18px;border-radius:12px;font-size:13px;font-weight:700;cursor:pointer}
.btn:hover{background:rgba(77,163,255,.3)}
.btn-sm{padding:8px 14px;font-size:11px}
.acts{display:flex;gap:8px;justify-content:flex-end}
.cat{background:#141d35;border:1.5px solid #213055;border-radius:16px;margin:16px 0;overflow:hidden}
.cat-hdr{padding:18px 20px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,rgba(77,163,255,.08),rgba(168,85,247,.05))}
.cat-hdr:hover{background:linear-gradient(135deg,rgba(77,163,255,.12),rgba(168,85,247,.08))}
.cat-hdr.exp{background:linear-gradient(135deg,rgba(77,163,255,.15),rgba(168,85,247,.1));border-bottom:1px solid #213055}
.cat-ttl{display:flex;align-items:center;gap:12px;font-size:15px;font-weight:800}
.cat-ico{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;background:rgba(77,163,255,.2);border:1px solid rgba(77,163,255,.3)}
.cat-cnt{font-size:11px;padding:4px 10px;border-radius:12px;background:rgba(77,163,255,.2);color:#e3f2ff;font-weight:800}
.cat-arr{font-size:20px;transition:transform .3s;color:#9fb0d0}
.cat-hdr.exp .cat-arr{transform:rotate(180deg)}
.cat-body{max-height:0;overflow:hidden;transition:max-height .4s}
.cat-body.exp{max-height:50000px}
.med{background:linear-gradient(135deg,#1a2442,#141d35);border:1.5px solid #213055;border-radius:14px;padding:16px;margin:12px;cursor:pointer;transition:all .2s}
.med:hover{border-color:rgba(77,163,255,.4);transform:translateY(-2px)}
.med.exp{cursor:default;border-color:rgba(77,163,255,.5)}
.med-c{display:block}.med-e{display:none}
.med.exp .med-c{display:none}.med.exp .med-e{display:block}
.med-hdr{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
.med-nm{font-size:15px;font-weight:900;flex:1}
.med-nmf{font-size:17px;font-weight:900;margin-bottom:12px}
.fav{font-size:20px;cursor:pointer}
.badge{font-size:10px;padding:5px 10px;border-radius:10px;font-weight:900;text-transform:uppercase;white-space:nowrap}
.b-ok{background:rgba(22,163,74,.25);color:#dcfce7;border:1px solid rgba(22,163,74,.5)}
.b-warn{background:rgba(245,158,11,.25);color:#fef3c7;border:1px solid rgba(245,158,11,.5)}
.b-bad{background:rgba(239,68,68,.25);color:#fee2e2;border:1px solid rgba(239,68,68,.5)}
.b-was{background:rgba(16,185,129,.25);color:#d1fae5;border:1px solid rgba(16,185,129,.5);margin-left:4px}
.dose-c{font-size:16px;font-weight:900;color:#4da3ff;margin:8px 0;line-height:1.4}
.dose-e{font-size:18px;font-weight:900;color:#4da3ff;margin:12px 0;padding:12px;border-radius:12px;background:rgba(77,163,255,.08);border:1px solid rgba(77,163,255,.2);line-height:1.5}
.ml-c{font-size:13px;color:#e3f2ff;font-weight:700;margin:6px 0}
.ml-e{font-size:15px;color:#e3f2ff;background:rgba(77,163,255,.2);padding:10px 14px;border-radius:10px;display:inline-block;margin:8px 0;font-weight:800}
.freq-c{font-size:11px;color:#6b7a9a;margin-top:6px}
.freq-e{font-size:12px;color:#9fb0d0;background:rgba(77,163,255,.1);padding:6px 12px;border-radius:8px;display:inline-block;margin:8px 0}
.hint{font-size:11px;color:#6b7a9a;text-align:center;margin-top:10px;padding:8px;border-top:1px solid #213055}
.note{color:#6b7a9a;font-size:12px;line-height:1.6;margin-top:10px;padding:12px;background:rgba(0,0,0,.3);border-radius:10px;border:1px solid #213055}
.note strong{color:#e8f0ff}
.det{margin-top:10px;background:rgba(0,0,0,.25);border-radius:10px;border:1px solid #213055;overflow:hidden}
.det-h{cursor:pointer;font-weight:700;font-size:12px;padding:12px 14px;display:flex;justify-content:space-between;align-items:center}
.det-h:hover{background:rgba(77,163,255,.1)}
.det-h.open{background:rgba(77,163,255,.15);color:#e3f2ff}
.det-b{max-height:0;overflow:hidden;transition:max-height .3s}
.det-b.open{max-height:1000px}
.det-in{padding:12px 14px}
.det-ico{transition:transform .3s}
.det-h.open .det-ico{transform:rotate(180deg)}
.coll{width:100%;margin-top:16px}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);z-index:1000;align-items:center;justify-content:center}
.modal.active{display:flex}
.modal-c{background:#141d35;border:1.5px solid #213055;border-radius:20px;padding:24px;max-width:500px;width:90%;max-height:80vh;overflow-y:auto}
.modal-h{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid #213055}
.modal-x{cursor:pointer;font-size:28px;color:#6b7a9a}
.hist{background:rgba(77,163,255,.08);border:1px solid #213055;border-radius:12px;padding:14px;margin:10px 0;font-size:12px}
footer{padding:24px;color:#6b7a9a;font-size:11px;text-align:center;border-top:1px solid #213055;margin-top:32px}
@media(max-width:640px){.grid,.grid3{grid-template-columns:1fr}h1{font-size:18px}.med{margin:10px}}
</style>
</head>
<body>
<header>
<h1>üè• PHC Pediatric Dose & Formulary</h1>
<p class="sub">Saudi Growth Charts ‚Ä¢ Wasfaty ‚Ä¢ Offline PWA</p>
</header>
<div class="wrap">
<div class="warn-box">
<span style="font-size:24px">‚ö†Ô∏è</span>
<div><strong style="color:#fef3c7">Healthcare Professionals Only</strong><br>Verify against local protocols. Check interactions and max doses.</div>
</div>
<div id="gAlert"></div>
<div class="card">
<div class="grid3">
<div class="fld"><label>Age (years)</label><input id="ageY" type="number" min="0" max="18" value="6" inputmode="numeric"></div>
<div class="fld"><label>+ Months</label><input id="ageM" type="number" min="0" max="11" value="0" inputmode="numeric"></div>
<div class="fld"><label>Sex <span style="color:#6b7a9a;font-weight:400;text-transform:none">for growth</span></label><select id="sex"><option value="">Select</option><option value="male">üë¶ Male</option><option value="female">üëß Female</option></select></div>
</div>
<div class="grid" style="margin-top:12px">
<div class="fld"><label>Weight (kg) *</label><input id="wt" type="number" min="0" max="150" step="0.1" value="20" inputmode="decimal"></div>
<div class="fld"><label>Height (cm) <span style="color:#6b7a9a;font-weight:400;text-transform:none">optional</span></label><input id="ht" type="number" min="0" max="200" step="0.1" value="" inputmode="decimal" placeholder="For BMI (‚â•5y)"></div>
</div>
<div class="sum" id="sumBox">‚Äî</div>
<div id="gSum"></div>
</div>
<div class="card">
<input class="search" id="srcBox" placeholder="Search medication or indication..." autocomplete="off">
<div class="acts">
<button class="btn btn-sm" id="favBtn">‚≠ê Favorites</button>
<button class="btn btn-sm" id="histBtn">üìã History</button>
</div>
</div>
<div id="catBox"></div>
<footer><strong>Saudi Edition by Aljarrah</strong><br>Saudi Growth Charts (El Mouzan 2005) ‚Ä¢ Lexicomp ‚Ä¢ BNFC ‚Ä¢ Wasfaty</footer>
</div>
<div class="modal" id="histModal">
<div class="modal-c">
<div class="modal-h"><h2 style="font-size:18px;font-weight:800">üìã History</h2><span class="modal-x" id="histX">√ó</span></div>
<div id="histList"></div>
<button class="btn" style="width:100%;margin-top:16px" id="histClr">Clear All</button>
</div>
</div>
<div class="modal" id="favModal">
<div class="modal-c">
<div class="modal-h"><h2 style="font-size:18px;font-weight:800">‚≠ê Favorites</h2><span class="modal-x" id="favX">√ó</span></div>
<div id="favList"></div>
</div>
</div>
<script>
/* Saudi Growth Charts ‚Äì El Mouzan et al. 2005/2007
   Data read from official Saudi growth chart PDFs (birth‚Äì60mo & 5‚Äì19y).
   Percentiles: 3, 10, 25, 50, 75, 90, 97 at key age points (months).
   BMI-for-age: ‚â•5 years ONLY (60+ months), using Saudi chart percentile cutoffs.
   Gender & height are OPTIONAL ‚Äì weight percentile works with age alone. */
const SG={male:{wt:{
0:{p3:2.5,p10:2.9,p25:3.2,p50:3.5,p75:3.9,p90:4.2,p97:4.5},
3:{p3:4.5,p10:5.0,p25:5.5,p50:6.2,p75:6.9,p90:7.5,p97:8.0},
6:{p3:6.0,p10:6.6,p25:7.2,p50:7.8,p75:8.5,p90:9.2,p97:9.8},
9:{p3:7.0,p10:7.7,p25:8.4,p50:9.1,p75:9.9,p90:10.7,p97:11.4},
12:{p3:7.8,p10:8.5,p25:9.3,p50:10.3,p75:11.3,p90:12.2,p97:12.9},
18:{p3:8.8,p10:9.6,p25:10.6,p50:11.6,p75:12.7,p90:13.7,p97:14.5},
24:{p3:10.0,p10:10.8,p25:11.8,p50:13.1,p75:14.4,p90:15.5,p97:16.5},
30:{p3:10.8,p10:11.7,p25:12.8,p50:14.1,p75:15.5,p90:16.7,p97:17.8},
36:{p3:11.5,p10:12.4,p25:13.6,p50:15.2,p75:16.7,p90:18.0,p97:19.2},
42:{p3:12.2,p10:13.1,p25:14.4,p50:16.1,p75:17.8,p90:19.3,p97:20.5},
48:{p3:13.0,p10:14.0,p25:15.3,p50:17.2,p75:19.0,p90:20.5,p97:21.8},
54:{p3:13.7,p10:14.7,p25:16.2,p50:18.2,p75:20.1,p90:21.8,p97:23.1},
60:{p3:14.5,p10:15.5,p25:17.1,p50:19.2,p75:21.3,p90:23.0,p97:24.4},
72:{p3:16.0,p10:17.3,p25:19.2,p50:21.8,p75:24.5,p90:26.7,p97:28.2},
84:{p3:17.5,p10:19.1,p25:21.4,p50:24.5,p75:27.8,p90:30.8,p97:33.2},
96:{p3:19.2,p10:21.0,p25:23.8,p50:27.4,p75:31.5,p90:35.0,p97:36.6},
108:{p3:21.0,p10:23.2,p25:26.5,p50:30.8,p75:35.8,p90:40.5,p97:43.0},
120:{p3:23.0,p10:25.5,p25:29.5,p50:34.2,p75:40.0,p90:44.5,p97:47.5},
132:{p3:25.5,p10:28.5,p25:33.0,p50:38.8,p75:46.0,p90:52.0,p97:56.0},
144:{p3:28.5,p10:32.0,p25:37.0,p50:44.5,p75:53.0,p90:60.0,p97:64.5},
156:{p3:32.0,p10:36.0,p25:41.5,p50:50.0,p75:59.0,p90:66.5,p97:71.0},
168:{p3:36.0,p10:40.0,p25:46.0,p50:55.0,p75:64.0,p90:72.0,p97:77.0},
180:{p3:39.0,p10:43.5,p25:49.5,p50:58.5,p75:67.5,p90:76.0,p97:82.0},
192:{p3:41.0,p10:45.5,p25:52.0,p50:61.0,p75:70.5,p90:80.0,p97:87.0},
204:{p3:43.0,p10:47.5,p25:53.5,p50:63.0,p75:73.0,p90:83.0,p97:90.0},
216:{p3:44.0,p10:48.5,p25:55.0,p50:64.5,p75:75.0,p90:85.0,p97:92.0},
228:{p3:45.0,p10:49.5,p25:56.0,p50:65.0,p75:76.0,p90:87.0,p97:95.0}
},ht:{
0:{p3:46,p10:47.5,p25:49,p50:50,p75:51.5,p90:53,p97:54},
3:{p3:56,p10:57.5,p25:59,p50:61,p75:63,p90:64.5,p97:65.5},
6:{p3:62,p10:64,p25:65.5,p50:67.5,p75:69.5,p90:71,p97:72},
9:{p3:66.5,p10:68,p25:70,p50:72,p75:74,p90:75.5,p97:77},
12:{p3:71,p10:73,p25:75,p50:79,p75:82,p90:85,p97:87},
18:{p3:76,p10:78,p25:80,p50:84,p75:87,p90:89.5,p97:91},
24:{p3:82,p10:84,p25:87,p50:93,p75:96,p90:99,p97:103},
36:{p3:89,p10:91,p25:95,p50:101,p75:105,p90:108,p97:112},
48:{p3:96,p10:98,p25:102,p50:109,p75:113,p90:117,p97:120},
60:{p3:102,p10:105,p25:109,p50:115,p75:120,p90:124,p97:127},
72:{p3:108,p10:111,p25:115,p50:121,p75:126,p90:130,p97:133},
84:{p3:113,p10:116,p25:120,p50:127,p75:132,p90:136,p97:139},
96:{p3:118,p10:121,p25:126,p50:133,p75:138,p90:143,p97:147},
108:{p3:123,p10:126,p25:131,p50:138,p75:144,p90:149,p97:153},
120:{p3:129,p10:132,p25:137,p50:147,p75:153,p90:159,p97:163},
132:{p3:133,p10:137,p25:143,p50:153,p75:160,p90:166,p97:170},
144:{p3:143,p10:147,p25:153,p50:164,p75:170,p90:176,p97:181},
156:{p3:148,p10:152,p25:158,p50:168,p75:174,p90:179,p97:183},
168:{p3:152,p10:156,p25:161,p50:170,p75:176,p90:181,p97:185},
180:{p3:154,p10:157,p25:162,p50:171,p75:177,p90:182,p97:186},
192:{p3:155,p10:158,p25:163,p50:172,p75:177,p90:182,p97:186},
204:{p3:155,p10:158,p25:163,p50:172,p75:178,p90:182,p97:186},
216:{p3:155,p10:159,p25:163,p50:172,p75:178,p90:182,p97:187}
},bmi:{
60:{p3:12.8,p10:13.4,p25:14.2,p50:15.2,p75:16.3,p85:17.2,p90:17.8,p95:18.8,p97:19.5},
72:{p3:12.8,p10:13.4,p25:14.2,p50:15.3,p75:16.5,p85:17.5,p90:18.2,p95:19.4,p97:20.2},
84:{p3:12.9,p10:13.5,p25:14.4,p50:15.5,p75:16.8,p85:17.9,p90:18.8,p95:20.2,p97:21.2},
96:{p3:13.0,p10:13.7,p25:14.6,p50:15.8,p75:17.4,p85:18.6,p90:19.6,p95:21.2,p97:22.4},
108:{p3:13.2,p10:13.9,p25:14.9,p50:16.3,p75:18.2,p85:19.5,p90:20.6,p95:22.4,p97:23.6},
120:{p3:13.5,p10:14.2,p25:15.4,p50:17.0,p75:19.2,p85:20.6,p90:21.8,p95:23.8,p97:25.0},
132:{p3:13.8,p10:14.6,p25:15.9,p50:17.8,p75:20.2,p85:21.8,p90:23.0,p95:25.2,p97:26.5},
144:{p3:14.2,p10:15.1,p25:16.5,p50:18.6,p75:21.2,p85:23.0,p90:24.2,p95:26.5,p97:28.0},
156:{p3:14.8,p10:15.6,p25:17.2,p50:19.5,p75:22.2,p85:24.0,p90:25.4,p95:27.8,p97:29.4},
168:{p3:15.4,p10:16.2,p25:17.8,p50:20.2,p75:23.0,p85:24.8,p90:26.2,p95:28.6,p97:30.2},
180:{p3:16.0,p10:16.8,p25:18.4,p50:20.8,p75:23.5,p85:25.3,p90:26.8,p95:29.2,p97:30.8},
192:{p3:16.5,p10:17.3,p25:18.8,p50:21.2,p75:24.0,p85:25.8,p90:27.2,p95:29.6,p97:31.2},
204:{p3:16.8,p10:17.6,p25:19.2,p50:21.5,p75:24.3,p85:26.0,p90:27.5,p95:30.0,p97:31.8},
216:{p3:17.0,p10:17.8,p25:19.5,p50:21.8,p75:24.5,p85:26.2,p90:27.8,p95:30.5,p97:32.5},
228:{p3:17.2,p10:18.0,p25:19.8,p50:22.0,p75:25.0,p85:26.8,p90:28.5,p95:31.5,p97:34.0}
}},female:{wt:{
0:{p3:2.4,p10:2.8,p25:3.1,p50:3.4,p75:3.8,p90:4.1,p97:4.4},
3:{p3:4.2,p10:4.6,p25:5.1,p50:5.7,p75:6.3,p90:6.9,p97:7.3},
6:{p3:5.5,p10:6.0,p25:6.5,p50:7.3,p75:8.0,p90:8.7,p97:9.3},
9:{p3:6.5,p10:7.0,p25:7.7,p50:8.5,p75:9.3,p90:10.0,p97:10.6},
12:{p3:7.3,p10:7.9,p25:8.6,p50:9.7,p75:10.6,p90:11.5,p97:12.3},
18:{p3:8.3,p10:9.0,p25:9.8,p50:10.8,p75:11.9,p90:12.9,p97:13.6},
24:{p3:9.5,p10:10.3,p25:11.2,p50:12.6,p75:13.8,p90:15.0,p97:16.0},
30:{p3:10.2,p10:11.1,p25:12.1,p50:13.5,p75:14.8,p90:16.0,p97:17.0},
36:{p3:11.0,p10:11.8,p25:13.0,p50:14.6,p75:16.0,p90:17.3,p97:18.6},
42:{p3:11.6,p10:12.5,p25:13.7,p50:15.4,p75:17.0,p90:18.4,p97:19.6},
48:{p3:12.5,p10:13.4,p25:14.6,p50:16.5,p75:18.2,p90:19.8,p97:21.1},
54:{p3:13.2,p10:14.1,p25:15.4,p50:17.4,p75:19.2,p90:21.0,p97:22.3},
60:{p3:14.0,p10:15.0,p25:16.3,p50:18.4,p75:20.5,p90:22.2,p97:23.6},
72:{p3:15.5,p10:16.7,p25:18.3,p50:20.9,p75:23.5,p90:25.7,p97:27.2},
84:{p3:17.0,p10:18.4,p25:20.4,p50:23.6,p75:26.8,p90:29.5,p97:31.5},
96:{p3:18.7,p10:20.3,p25:22.8,p50:26.6,p75:30.5,p90:33.8,p97:35.8},
108:{p3:20.5,p10:22.5,p25:25.5,p50:30.0,p75:34.8,p90:39.0,p97:42.0},
120:{p3:22.8,p10:25.0,p25:28.5,p50:34.2,p75:40.0,p90:44.8,p97:48.0},
132:{p3:25.5,p10:28.0,p25:32.5,p50:39.0,p75:46.0,p90:52.0,p97:56.0},
144:{p3:29.0,p10:32.0,p25:37.0,p50:46.0,p75:53.0,p90:59.5,p97:64.8},
156:{p3:33.0,p10:36.5,p25:41.0,p50:49.5,p75:57.0,p90:63.5,p97:68.5},
168:{p3:36.0,p10:39.5,p25:44.0,p50:52.0,p75:60.0,p90:67.0,p97:72.0},
180:{p3:38.0,p10:41.0,p25:46.0,p50:54.0,p75:62.0,p90:70.0,p97:75.5},
192:{p3:39.0,p10:42.0,p25:47.0,p50:55.0,p75:63.5,p90:72.0,p97:78.0},
204:{p3:39.5,p10:42.5,p25:47.5,p50:55.5,p75:64.0,p90:73.0,p97:80.0},
216:{p3:40.0,p10:43.0,p25:48.0,p50:56.0,p75:65.0,p90:74.0,p97:82.0},
228:{p3:40.5,p10:43.5,p25:48.5,p50:56.5,p75:66.0,p90:75.0,p97:84.0}
},ht:{
0:{p3:45,p10:46.5,p25:48,p50:49,p75:50.5,p90:52,p97:53},
3:{p3:55,p10:56.5,p25:58,p50:59.5,p75:61.5,p90:63,p97:64},
6:{p3:61,p10:62.5,p25:64,p50:66,p75:68,p90:69.5,p97:70.5},
9:{p3:65,p10:66.5,p25:68.5,p50:70.5,p75:72.5,p90:74,p97:75},
12:{p3:70,p10:72,p25:74,p50:78,p75:81,p90:84,p97:86},
18:{p3:75,p10:77,p25:79,p50:82.5,p75:86,p90:88,p97:90},
24:{p3:81,p10:83,p25:86,p50:92,p75:95,p90:98,p97:102},
36:{p3:88,p10:90,p25:94,p50:100,p75:104,p90:107,p97:111},
48:{p3:95,p10:97,p25:101,p50:108,p75:112,p90:116,p97:119},
60:{p3:101,p10:104,p25:108,p50:114,p75:119,p90:123,p97:126},
72:{p3:107,p10:110,p25:114,p50:120,p75:125,p90:129,p97:132},
84:{p3:112,p10:115,p25:119,p50:126,p75:131,p90:135,p97:138},
96:{p3:118,p10:121,p25:126,p50:133,p75:138,p90:143,p97:147},
108:{p3:123,p10:127,p25:132,p50:139,p75:145,p90:150,p97:154},
120:{p3:131,p10:134,p25:139,p50:149,p75:155,p90:160,p97:165},
132:{p3:137,p10:140,p25:145,p50:154,p75:160,p90:164,p97:168},
144:{p3:146,p10:148,p25:152,p50:159,p75:163,p90:166,p97:170},
156:{p3:148,p10:150,p25:154,p50:160,p75:164,p90:167,p97:171},
168:{p3:149,p10:151,p25:155,p50:160,p75:164,p90:167,p97:171},
180:{p3:149,p10:151,p25:155,p50:160,p75:164,p90:167,p97:171},
192:{p3:149,p10:151,p25:155,p50:160,p75:164,p90:167,p97:171},
204:{p3:149,p10:151,p25:155,p50:160,p75:164,p90:167,p97:171},
216:{p3:149,p10:151,p25:155,p50:160,p75:164,p90:167,p97:171}
},bmi:{
60:{p3:12.5,p10:13.2,p25:14.0,p50:15.0,p75:16.0,p85:16.8,p90:17.4,p95:18.5,p97:19.2},
72:{p3:12.5,p10:13.2,p25:14.0,p50:15.0,p75:16.2,p85:17.2,p90:17.8,p95:19.0,p97:19.8},
84:{p3:12.6,p10:13.3,p25:14.2,p50:15.3,p75:16.6,p85:17.6,p90:18.4,p95:19.8,p97:20.8},
96:{p3:12.8,p10:13.5,p25:14.4,p50:15.6,p75:17.2,p85:18.4,p90:19.4,p95:21.0,p97:22.2},
108:{p3:13.0,p10:13.8,p25:14.8,p50:16.2,p75:18.0,p85:19.4,p90:20.5,p95:22.4,p97:23.6},
120:{p3:13.4,p10:14.2,p25:15.3,p50:17.0,p75:19.0,p85:20.6,p90:21.8,p95:24.0,p97:25.4},
132:{p3:13.8,p10:14.6,p25:15.8,p50:17.8,p75:20.2,p85:22.0,p90:23.4,p95:25.8,p97:27.2},
144:{p3:14.4,p10:15.2,p25:16.5,p50:18.8,p75:21.4,p85:23.2,p90:24.6,p95:27.2,p97:28.8},
156:{p3:15.0,p10:15.8,p25:17.2,p50:19.5,p75:22.2,p85:24.0,p90:25.5,p95:28.0,p97:29.8},
168:{p3:15.5,p10:16.4,p25:17.8,p50:20.0,p75:22.8,p85:24.6,p90:26.0,p95:28.5,p97:30.2},
180:{p3:16.0,p10:16.8,p25:18.2,p50:20.5,p75:23.2,p85:25.0,p90:26.4,p95:28.8,p97:30.5},
192:{p3:16.3,p10:17.2,p25:18.5,p50:20.8,p75:23.5,p85:25.2,p90:26.6,p95:29.0,p97:30.8},
204:{p3:16.5,p10:17.4,p25:18.8,p50:21.0,p75:23.8,p85:25.5,p90:27.0,p95:29.5,p97:31.5},
216:{p3:16.8,p10:17.6,p25:19.0,p50:21.2,p75:24.0,p85:25.8,p90:27.5,p95:30.5,p97:33.0},
228:{p3:17.0,p10:17.8,p25:19.2,p50:21.5,p75:24.5,p85:26.5,p90:28.0,p95:31.5,p97:34.0}
}}};
function gAge(a,d){const k=Object.keys(d).map(Number).sort((x,y)=>x-y);return k.reduce((p,c)=>Math.abs(c-a)<Math.abs(p-a)?c:p);}
function gPercRange(v,pd){
if(!pd)return null;
const pcts=[{k:'p3',n:3},{k:'p10',n:10},{k:'p25',n:25},{k:'p50',n:50},{k:'p75',n:75},{k:'p90',n:90},{k:'p97',n:97}];
if(v<pd.p3)return'<3rd';if(v>pd.p97)return'>97th';
for(let i=0;i<pcts.length-1;i++){if(v>=pd[pcts[i].k]&&v<=pd[pcts[i+1].k])return pcts[i].n+'‚Äì'+pcts[i+1].n+'th';}
return'~50th';
}
function gBmiRange(v,pd){
if(!pd)return null;
const pcts=[{k:'p3',n:3},{k:'p10',n:10},{k:'p25',n:25},{k:'p50',n:50},{k:'p75',n:75},{k:'p85',n:85},{k:'p90',n:90},{k:'p95',n:95},{k:'p97',n:97}];
if(v<pd.p3)return{r:'<3rd',st:'Underweight'};if(v>pd.p97)return{r:'>97th',st:'Obese'};
let lo=pcts[0],hi=pcts[pcts.length-1];
for(let i=0;i<pcts.length-1;i++){if(v>=pd[pcts[i].k]&&v<=pd[pcts[i+1].k]){lo=pcts[i];hi=pcts[i+1];break;}}
const rng=lo.n+'‚Äì'+hi.n+'th';
let st='Normal';if(hi.n<=10)st='Underweight';else if(lo.n>=85&&lo.n<95)st='Overweight';else if(lo.n>=95)st='Obese';
return{r:rng,st:st};
}
function chkG(am,w,h,s){
if(!w)return null;
if(!s)return null;
const d=SG[s];if(!d)return null;
const r={wt:null,ht:null,bmi:null,alerts:[]};
const wa=gAge(am,d.wt),wd=d.wt[wa];
if(wd){
const p=gPercRange(w,wd);r.wt={v:w,p:p};
if(w<wd.p3)r.alerts.push({t:'bad',m:'Weight <b>&lt;3rd</b> percentile ‚Äì evaluate FTT/malnutrition'});
else if(w>wd.p97)r.alerts.push({t:'warn',m:'Weight <b>&gt;97th</b> percentile'});
}
if(h&&h>0){
const ha=gAge(am,d.ht),hd=d.ht[ha];
if(hd){
const p=gPercRange(h,hd);r.ht={v:h,p:p};
if(h<hd.p3)r.alerts.push({t:'bad',m:'Height <b>&lt;3rd</b> percentile ‚Äì evaluate short stature'});
else if(h>hd.p97)r.alerts.push({t:'info',m:'Height <b>&gt;97th</b> percentile'});
}
if(am>=60&&d.bmi){
const bmi=w/((h/100)**2);
const ba=gAge(am,d.bmi),bd=d.bmi[ba];
if(bd){
const br=gBmiRange(bmi,bd);
r.bmi={v:bmi.toFixed(1),p:br.r,st:br.st};
if(br.st==='Obese')r.alerts.push({t:'bad',m:'BMI <b>&gt;95th</b> percentile ‚Äì <b>Obese</b>'});
else if(br.st==='Overweight')r.alerts.push({t:'warn',m:'BMI <b>85‚Äì95th</b> percentile ‚Äì <b>Overweight</b>'});
else if(br.st==='Underweight')r.alerts.push({t:'warn',m:'BMI <b>&lt;10th</b> percentile ‚Äì <b>Underweight</b>'});
}
}
}
return r;
}
const CATS=["Emergency","Asthma","Antihistamines","Cough & Cold","ENT","GI","Antibiotics","Pain/Fever","Vitamins"];
const ICOS={"Emergency":"üö®","Asthma":"üí®","Antihistamines":"ü§ß","Cough & Cold":"ü§í","ENT":"üëÇ","GI":"üè•","Antibiotics":"üíä","Pain/Fever":"üå°Ô∏è","Vitamins":"üíä"};
const MEDS=[
{id:"epi",cat:"Emergency",nm:"Epinephrine IM",sn:"Adrenaline IM",was:false,ind:"Anaphylaxis",ci:"None in emergency",mth:"epi",minM:0,maxM:216,frq:"q5-15min PRN",note:"0.01 mg/kg IM (max 0.5mg, 0.3mg if <30kg)",tips:"‚ö†Ô∏è IM anterolateral thigh ONLY. Observe 4-6h.",se:"Tachycardia, tremor",conc:[{l:"1 mg/mL",c:1}]},
{id:"dex",cat:"Emergency",nm:"Dexamethasone (Croup)",sn:"Dexamethasone",was:false,ind:"Croup",ci:"Active fungal infection",mth:"dex",minM:3,maxM:72,frq:"Single dose",note:"Mild: 0.15 mg/kg | Severe: 0.6 mg/kg (max 10mg)",tips:"PO preferred. Effect lasts 24-72h.",conc:[{l:"4 mg/mL",c:4}]},
{id:"salb_n",cat:"Asthma",nm:"Salbutamol Nebulizer",sn:"Salbutamol Neb",was:true,ind:"Acute asthma, bronchospasm",ci:"Hypersensitivity",mth:"salb_n",minM:0,maxM:216,frq:"q20min x3, then q1-4h",note:"0.15 mg/kg/dose (min 2.5mg, max 5mg)",tips:"‚ö†Ô∏è Monitor HR. Dilute to 3-4mL NS.",se:"Tachycardia, tremor, hypokalemia",conc:[{l:"5 mg/mL",c:5}]},
{id:"salb_m",cat:"Asthma",nm:"Salbutamol MDI",sn:"Salbutamol MDI",was:true,ind:"Mild-moderate asthma",ci:"Hypersensitivity",mth:"salb_m",minM:0,maxM:216,frq:"q4-6h PRN",note:"100 mcg/puff. ALWAYS use spacer.",tips:"‚úì 1 neb ‚âà 6 puffs with spacer."},
{id:"ipra",cat:"Asthma",nm:"Ipratropium Neb",sn:"Ipratropium",was:false,ind:"Severe asthma (add-on)",ci:"Atropine allergy",mth:"ipra",minM:0,maxM:216,frq:"q20min x3 (first hour)",note:"<6y: 250mcg | ‚â•6y: 500mcg",tips:"Mix with salbutamol. First 3 doses only."},
{id:"pred",cat:"Asthma",nm:"Prednisolone",sn:"Prednisolone",was:true,ind:"Asthma exacerbation, croup, allergic reactions",ci:"Systemic fungal infection",mth:"pred",minM:0,maxM:216,frq:"Once daily x3-5 days",note:"1 mg/kg/day (max 40mg children)",tips:"Give with food. Morning dose. No taper if ‚â§7d.",se:"Hyperactivity, increased appetite",conc:[{l:"5 mg/5mL",c:1},{l:"15 mg/5mL",c:3}]},
{id:"mont",cat:"Asthma",nm:"Montelukast",sn:"Montelukast",was:true,ind:"Asthma prevention, allergic rhinitis",ci:"Hypersensitivity",mth:"mont",minM:6,maxM:216,frq:"Once daily (evening)",note:"6mo-5y: 4mg | 6-14y: 5mg | ‚â•15y: 10mg",tips:"‚ö†Ô∏è FDA black box: neuropsychiatric effects. Not for acute."},
{id:"bud_f",cat:"Asthma",nm:"Budesonide/Formoterol 160/4.5",sn:"Symbicort SMART",was:true,ind:"Asthma SMART ‚â•6y",ci:"<6y",mth:"fix",minM:72,maxM:216,frq:"BID + PRN",fix:"Maint: 1-2 puffs BID | PRN: 1 puff | Max 8/day (6-11y)",tips:"‚úì Controller + reliever. Rinse mouth."},
{id:"flut_s",cat:"Asthma",nm:"Fluticasone/Salmeterol 125/25",sn:"Seretide",was:true,ind:"Asthma maintenance ‚â•6y",ci:"<6y, acute asthma",mth:"fix",minM:72,maxM:216,frq:"BID",fix:"1 puff BID. Need separate reliever.",tips:"‚ö†Ô∏è NOT for acute. Rinse mouth."},
{id:"cet",cat:"Antihistamines",nm:"Cetirizine",sn:"Cetirizine",was:false,ind:"Allergic rhinitis, urticaria",ci:"<2y (safety not established)",mth:"cet",minM:24,maxM:216,frq:"Once daily",note:"2-5y: 2.5-5mg | ‚â•6y: 5-10mg",tips:"‚ö†Ô∏è NOT for <2y - use Fenistil instead.",se:"Mild drowsiness",conc:[{l:"5 mg/5mL",c:1}]},
{id:"lor",cat:"Antihistamines",nm:"Loratadine",sn:"Loratadine",was:false,ind:"Allergic rhinitis, urticaria",ci:"<2y",mth:"lor",minM:24,maxM:216,frq:"Once daily",note:"2-5y: 5mg | ‚â•6y: 10mg",tips:"Non-sedating.",conc:[{l:"5 mg/5mL",c:1}]},
{id:"chl",cat:"Antihistamines",nm:"Chlorpheniramine",sn:"Chlorpheniramine",was:true,ind:"Allergic conditions, pruritus",ci:"<1y, MAOIs",mth:"chl",minM:12,maxM:216,frq:"q4-6h PRN (max 4/day)",note:"1-2y: 1mg | 2-5y: 1mg | 6-12y: 2mg | >12y: 4mg",tips:"‚ö†Ô∏è SEDATING. May cause paradoxical excitation.",se:"Sedation, dry mouth",conc:[{l:"2 mg/5mL",c:0.4}]},
{id:"fen",cat:"Antihistamines",nm:"Fenistil (Dimethindene)",sn:"Fenistil Drops",was:false,ind:"Allergic conditions - SAFE ‚â•1 month",ci:"<1 month, premature",mth:"fen",minM:1,maxM:144,frq:"TID",note:"2 drops/kg/day √∑ TID | 1 drop=0.05mg | Max 14 days",tips:"‚ö†Ô∏è <1y: SLEEP APNEA risk. Use only if essential. Can add to warm bottle.",se:"Drowsiness, fatigue",conc:[{l:"1 mg/mL",c:1}]},
{id:"dph",cat:"Cough & Cold",nm:"Diphenhydramine + Menthol",sn:"Diphenhydramine Cough",was:true,ind:"Dry cough (‚ö†Ô∏è NOT <6y)",ci:"<6y (not recommended), acute asthma",mth:"dph",minM:72,maxM:216,frq:"q6-8h PRN",note:"Diphenhydramine 1.4mg/mL + Menthol<br>‚ö†Ô∏è Combined cough syrups NOT recommended <6y",tips:"‚ö†Ô∏è SEDATING. NOT for <6y. Not for productive cough.",se:"Sedation"},
{id:"tri",cat:"Cough & Cold",nm:"Triprolidine/DM/Pseudoephedrine",sn:"Triprolidine Combo",was:true,ind:"Cough + congestion (‚ö†Ô∏è NOT <6y)",ci:"<6y (NOT recommended), MAOIs, hypertension",mth:"tri",minM:72,maxM:216,frq:"q6-8h PRN (max 4/day)",note:"Triprolidine 0.25mg/mL + DM 2mg/mL + Pseudo 6mg/mL<br>‚ö†Ô∏è Combined cough syrups NOT recommended <6y",tips:"‚ö†Ô∏è NOT for <6y. Contains decongestant. Sedating.",se:"Sedation, tachycardia"},
{id:"dxm",cat:"Cough & Cold",nm:"Dextromethorphan",sn:"Dextromethorphan",was:true,ind:"Dry cough (‚ö†Ô∏è NOT <6y)",ci:"<6y (not recommended), MAOIs, productive cough",mth:"dxm",minM:72,maxM:216,frq:"q6-8h PRN",note:"3 mg/mL<br>‚ö†Ô∏è Cough suppressants NOT recommended <6y",tips:"‚ö†Ô∏è NOT for <6y. Not for productive cough. Limited evidence.",se:"Dizziness, drowsiness"},
{id:"mom",cat:"ENT",nm:"Mometasone Nasal 0.05%",sn:"Mometasone Nasal",was:true,ind:"Allergic rhinitis",ci:"Nasal infection",mth:"fix",minM:24,maxM:216,frq:"Once daily",fix:"2-11y: 1 spray/nostril | ‚â•12y: 2 sprays/nostril",tips:"‚úì Aim away from septum. Takes 1-2 weeks."},
{id:"flu_n",cat:"ENT",nm:"Fluticasone Nasal 0.05%",sn:"Fluticasone Nasal",was:true,ind:"Allergic rhinitis",ci:"Nasal infection",mth:"fix",minM:48,maxM:216,frq:"Daily",fix:"4-11y: 1 spray/nostril | ‚â•12y: 1-2 sprays/nostril",tips:"Shake before use."},
{id:"bud_n",cat:"ENT",nm:"Budesonide Nasal 64mcg",sn:"Budesonide Nasal",was:true,ind:"Allergic rhinitis",ci:"Nasal infection",mth:"fix",minM:72,maxM:216,frq:"Daily-BID",fix:"‚â•6y: 1-2 sprays/nostril daily-BID",tips:"Prime before first use."},
{id:"sal",cat:"ENT",nm:"Saline Nasal",sn:"Saline Nasal",was:true,ind:"Nasal congestion - ALL ages",ci:"None",mth:"fix",minM:0,maxM:216,frq:"PRN",fix:"1-2 drops/sprays each nostril PRN",tips:"‚úì First-line for infants. Before feeds."},
{id:"xyl",cat:"ENT",nm:"Xylometazoline 0.05%",sn:"Xylometazoline",was:true,ind:"Nasal congestion (MAX 3-5 days)",ci:"<2y, prolonged use",mth:"fix",minM:24,maxM:216,frq:"BID-TID (MAX 5 DAYS)",fix:"2-6y: 1-2 drops BID-TID | >6y: 2-3 drops BID-TID",tips:"‚ö†Ô∏è MAX 5 DAYS. Rebound congestion."},
{id:"ond",cat:"GI",nm:"Ondansetron",sn:"Ondansetron",was:false,ind:"Vomiting in AGE",ci:"Long QT, QT drugs",mth:"ond",minM:6,maxM:216,frq:"Single dose",note:"8-15kg: 2mg | 15-30kg: 4mg | >30kg: 8mg",tips:"‚úì ODT dissolves on tongue. Give before ORS.",se:"Headache, constipation",conc:[{l:"4 mg/5mL",c:0.8}]},
{id:"lac",cat:"GI",nm:"Lactulose",sn:"Lactulose",was:true,ind:"Constipation",ci:"Galactosemia",mth:"lac",minM:1,maxM:216,frq:"Daily-BID",note:"Adjust for 1-2 soft stools/day",tips:"Takes 24-48h. Increase fluids.",conc:[{l:"667 mg/mL",c:667}]},
{id:"dom",cat:"GI",nm:"Domperidone",sn:"Domperidone",was:true,ind:"‚ö†Ô∏è N/V: ONLY ‚â•12y & ‚â•35kg<br><12y: Use LOWEST dose if essential",ci:"Cardiac disease, QT prolongation, hepatic impairment, <35kg for N/V",mth:"dom",minM:0,maxM:216,frq:"TID before meals",note:"<12y (if essential): 250 mcg/kg TID<br>‚â•12y & ‚â•35kg: 10mg TID<br><b>MAX 1 WEEK</b>",tips:"‚ö†Ô∏è CARDIAC RISK. <12y: NOT for routine N/V - use lowest dose, shortest time. Review regularly.",se:"QT prolongation, extrapyramidal",conc:[{l:"1 mg/mL",c:1}]},
{id:"hyo",cat:"GI",nm:"Hyoscine Butylbromide",sn:"Hyoscine",was:true,ind:"Abdominal cramps, colic",ci:"Glaucoma, ileus",mth:"hyo",minM:72,maxM:216,frq:"TID PRN",note:"6-12y: 5-10mg TID | >12y: 10-20mg TID",tips:"Take before meals.",conc:[{l:"5 mg/5mL",c:1}]},
{id:"amx",cat:"Antibiotics",nm:"Amoxicillin 250mg/5mL",sn:"Amoxicillin",was:true,ind:"<b>Standard (40-50):</b> Pharyngitis, mild CAP<br><b>High (80-90):</b> AOM, sinusitis, severe CAP",ci:"PCN allergy, EBV",mth:"amx",minM:0,maxM:216,frq:"q8h",note:"Standard: 40-50 mg/kg/day | High: 80-90 mg/kg/day",tips:"‚úì Shake. Refrigerate. Complete course.",conc:[{l:"250 mg/5mL",c:50}]},
{id:"aug",cat:"Antibiotics",nm:"Co-amoxiclav (Augmentin)",sn:"Co-amoxiclav",was:true,ind:"<b>Standard:</b> Bites, mild skin<br><b>High dose:</b> Resistant AOM, severe sinusitis",ci:"PCN allergy, previous jaundice with augmentin",mth:"aug",minM:0,maxM:216,frq:"q8-12h",note:"Dose on AMOXICILLIN component",tips:"‚ö†Ô∏è Give WITH FOOD. More diarrhea.",conc:[{l:"25mg amox/mL",c:25}]},
{id:"azi",cat:"Antibiotics",nm:"Azithromycin 200mg/5mL",sn:"Azithromycin",was:true,ind:"10mg/kg/day x3d: Atypical pneumonia, pertussis, GAS (PCN allergy)",ci:"Macrolide allergy, QT drugs",mth:"azi",minM:6,maxM:216,frq:"Once daily x3 days",note:"10 mg/kg/day (max 500mg) x 3 days",tips:"‚ö†Ô∏è QT risk. 3-day = 5-day efficacy.",conc:[{l:"200 mg/5mL",c:40}]},
{id:"cef",cat:"Antibiotics",nm:"Cefuroxime 125mg/5mL",sn:"Cefuroxime",was:true,ind:"20-30 mg/kg/day: AOM (2nd line), sinusitis, UTI",ci:"Cephalosporin allergy",mth:"cef",minM:3,maxM:216,frq:"q12h",note:"20-30 mg/kg/day √∑ BID (max 500mg)",tips:"Give WITH FOOD. Bitter.",conc:[{l:"125 mg/5mL",c:25}]},
{id:"tmp",cat:"Antibiotics",nm:"TMP-SMX",sn:"TMP-SMX",was:true,ind:"UTI, MRSA skin infections (NOT for strep)",ci:"Sulfa allergy, G6PD, <2mo",mth:"tmp",minM:2,maxM:216,frq:"q12h",note:"6-12 mg TMP/kg/day √∑ BID",tips:"‚ö†Ô∏è Hydration. Photosensitivity.",conc:[{l:"40mg TMP/5mL",c:8}]},
{id:"met",cat:"Antibiotics",nm:"Metronidazole 125mg/5mL",sn:"Metronidazole",was:true,ind:"Giardia, amoebiasis, C. diff, anaerobes",ci:"Alcohol use",mth:"met",minM:0,maxM:216,frq:"q8h",note:"Giardia: 15 mg/kg/day | Anaerobic: 22.5-30 mg/kg/day",tips:"‚ö†Ô∏è NO ALCOHOL during + 48h after.",conc:[{l:"125 mg/5mL",c:25}]},
{id:"p120",cat:"Pain/Fever",nm:"Paracetamol 120mg/5mL",sn:"Paracetamol 120",was:true,ind:"Fever, mild-moderate pain",ci:"Severe hepatic impairment",mth:"para",minM:0,maxM:216,frq:"q4-6h PRN (max 4/day)",note:"10-15 mg/kg/dose | Max 75mg/kg/day",tips:"‚ö†Ô∏è Check for paracetamol in other products.",conc:[{l:"120 mg/5mL",c:24}]},
{id:"p160",cat:"Pain/Fever",nm:"Paracetamol 160mg/5mL SF",sn:"Paracetamol 160 SF",was:true,ind:"Fever, pain (sugar-free)",ci:"Severe hepatic impairment",mth:"para",minM:0,maxM:216,frq:"q4-6h PRN (max 4/day)",note:"10-15 mg/kg/dose | Sugar-free",tips:"‚úì Sugar-free for diabetics.",conc:[{l:"160 mg/5mL",c:32}]},
{id:"ps100",cat:"Pain/Fever",nm:"Paracetamol Supp 100mg",sn:"Paracetamol Supp 100",was:true,ind:"Fever (when vomiting)",ci:"Rectal pathology",mth:"paras",minM:0,maxM:216,frq:"q4-6h PRN",note:"10-15 mg/kg/dose",tips:"‚úì Use when vomiting. Moisten."},
{id:"ps125",cat:"Pain/Fever",nm:"Paracetamol Supp 125mg",sn:"Paracetamol Supp 125",was:true,ind:"Fever (when vomiting)",ci:"Rectal pathology",mth:"paras",minM:0,maxM:216,frq:"q4-6h PRN",note:"10-15 mg/kg/dose",tips:"‚úì Refrigerate."},
{id:"ibs",cat:"Pain/Fever",nm:"Ibuprofen 100mg/5mL",sn:"Ibuprofen Syrup",was:true,ind:"Fever, pain, inflammation",ci:"<6mo, GI bleeding, dehydration",mth:"ibu",minM:6,maxM:216,frq:"q6-8h PRN",note:"5-10 mg/kg/dose | Max 40mg/kg/day",tips:"‚úì Give with food. Ensure hydration.",conc:[{l:"100 mg/5mL",c:20}]},
{id:"ibt",cat:"Pain/Fever",nm:"Ibuprofen 400mg Tab",sn:"Ibuprofen 400 Tab",was:true,ind:"Fever, pain (‚â•12y)",ci:"<12y, GI bleeding",mth:"fix",minM:144,maxM:216,frq:"q6-8h PRN",fix:"200-400mg q6-8h (max 1.2g/day)",tips:"‚úì Give with food."},
{id:"dic",cat:"Pain/Fever",nm:"Diclofenac Supp 12.5mg",sn:"Diclofenac Supp",was:true,ind:"Moderate-severe fever, inflammatory pain",ci:"<6mo, GI bleeding, dehydration",mth:"dic",minM:6,maxM:216,frq:"BID-TID (MAX 3 days)",note:"0.5-1 mg/kg/dose | Max 3mg/kg/day",tips:"‚ö†Ô∏è Reserve for moderate-severe. MAX 3 days."},
{id:"vdd",cat:"Vitamins",nm:"Vitamin D3 Drops 2800 IU/mL",sn:"Vitamin D Drops",was:true,ind:"<b>PREVENTION (4 drops=400 IU):</b><br>‚Ä¢ ALL breastfed infants<br>‚Ä¢ Formula <1L/day<br><b>TREATMENT:</b> By level",ci:"Hypercalcemia",mth:"vitd",minM:0,maxM:216,frq:"Once daily",note:"<b>Each drop = 100 IU</b><br><b>Prevention:</b> 400 IU (4 drops)<br><b>Treatment:</b><br>‚Ä¢ 20-29: 1000-2000 IU/d<br>‚Ä¢ 10-19: 2000-4000 IU/d<br>‚Ä¢ <10: 50,000 IU/wk x6-8wk",tips:"‚úì Give with fatty meal. Recheck in 3mo."},
{id:"vdc",cat:"Vitamins",nm:"Vitamin D3 Capsules",sn:"Vitamin D Caps",was:true,ind:"Treatment of documented deficiency",ci:"Hypercalcemia",mth:"fix",minM:72,maxM:216,frq:"As directed",fix:"<b>By Level:</b><br>‚Ä¢ 20-29: 1000-2000 IU daily<br>‚Ä¢ 10-19: 50,000 IU weekly x6wk<br>‚Ä¢ <10: 50,000 IU weekly x8wk<br><b>Maintenance:</b> 400-1000 IU daily",tips:"‚ö†Ô∏è 50,000 IU for treatment ONLY. Monitor."},
{id:"fed",cat:"Vitamins",nm:"Ferrous Sulfate Drops 25mg/mL",sn:"Iron Drops",was:true,ind:"<b>Treatment:</b> Iron deficiency anemia<br><b>Prevention:</b> Preterm, LBW, breastfed >4mo",ci:"Hemochromatosis",mth:"fe",minM:0,maxM:216,frq:"Daily or √∑ BID",note:"Treatment: 3-6 mg Fe/kg/day<br>Prevention: 1-2 mg Fe/kg/day",tips:"üí° Give with vit C. Dark stools normal. STAINS TEETH.",conc:[{l:"25 mg Fe/mL",c:25}]},
{id:"fep",cat:"Vitamins",nm:"Iron Polymaltose 10mg/mL",sn:"Iron Polymaltose",was:true,ind:"Iron deficiency (better tolerated)",ci:"Hemochromatosis",mth:"fe",minM:0,maxM:216,frq:"Daily",note:"Treatment: 3-6 mg Fe/kg/day<br>Prevention: 1-2 mg Fe/kg/day",tips:"‚úì Better tolerated. Can give with food.",conc:[{l:"10 mg Fe/mL",c:10}]}
];
let hist=JSON.parse(localStorage.getItem('hist')||'[]');
let favs=JSON.parse(localStorage.getItem('favs')||'[]');
let expC=JSON.parse(localStorage.getItem('expC')||'[]');
function rnd(x){if(!x||isNaN(x))return'';const n=Math.round(x*10)/10;return n>=10||Number.isInteger(n)?String(n):n.toFixed(1);}
function rndMl(ml){if(ml<1)return Math.round(ml*4)/4;if(ml<5)return Math.round(ml*2)/2;return Math.round(ml);}
function bg(s,l){return`<span class="badge b-${s}">${l}</span>`;}
function calc(med,am,w){
if(!w||w<=0)return{st:'bad',lb:'No wt',tx:'‚Äî'};
if(am<med.minM||am>med.maxM)return{st:'bad',lb:'Age',tx:'Not indicated'};
const m=med.mth;
if(m==='fix')return{st:'warn',lb:'Ref',tx:med.fix||'See notes'};
if(m==='epi'){let mg=0.01*w;mg=Math.min(mg,w<30?0.3:0.5);return{st:'ok',lb:'‚úì',tx:`${rnd(mg)} mg IM`};}
if(m==='dex'){return{st:'ok',lb:'‚úì',tx:`Mild: ${rnd(0.15*w)} mg | Severe: ${rnd(Math.min(0.6*w,10))} mg`};}
if(m==='salb_n'){let mg=Math.max(2.5,Math.min(0.15*w,5));return{st:'ok',lb:'‚úì',tx:`${rnd(mg)} mg (${rnd(mg/5)} mL)`};}
if(m==='salb_m')return{st:'warn',lb:'Ref',tx:am<24?'2-4 puffs':am<72?'4-6 puffs':'6-10 puffs'};
if(m==='ipra')return{st:'warn',lb:'Ref',tx:am<72?'250 mcg':'500 mcg'};
if(m==='pred'){const mg=Math.min(w,40);return{st:'ok',lb:'‚úì',tx:`${rnd(mg)} mg daily (1 mg/kg)`};}
if(m==='mont'){if(am<72)return{st:'ok',lb:'‚úì',tx:'4 mg chewable'};if(am<180)return{st:'ok',lb:'‚úì',tx:'5 mg chewable'};return{st:'ok',lb:'‚úì',tx:'10 mg tablet'};}
if(m==='cet'){if(am<24)return{st:'bad',lb:'<2y',tx:'‚ö†Ô∏è NOT recommended <2y'};if(am<72)return{st:'ok',lb:'‚úì',tx:'2.5-5 mg daily'};return{st:'ok',lb:'‚úì',tx:'5-10 mg daily'};}
if(m==='lor'){if(am<72)return{st:'ok',lb:'‚úì',tx:'5 mg daily'};return{st:'ok',lb:'‚úì',tx:'10 mg daily'};}
if(m==='chl'){if(am<24)return{st:'warn',lb:'Caution',tx:'1 mg/dose'};if(am<72)return{st:'ok',lb:'‚úì',tx:'1 mg/dose'};if(am<144)return{st:'ok',lb:'‚úì',tx:'2 mg/dose'};return{st:'ok',lb:'‚úì',tx:'4 mg/dose'};}
if(m==='fen'){const d=Math.round(2*w/3);return{st:am<12?'warn':'ok',lb:am<12?'<1y Care':'‚úì',tx:`${d} drops TID (${rnd(2*w)} drops/day)`};}
if(m==='dph'){if(am<72)return{st:'bad',lb:'<6y',tx:'‚ö†Ô∏è NOT recommended <6 years'};if(am<144)return{st:'warn',lb:'Caution',tx:'5-10 mL q6-8h'};return{st:'ok',lb:'‚úì',tx:'10-20 mL q6-8h'};}
if(m==='tri'){if(am<72)return{st:'bad',lb:'<6y',tx:'‚ö†Ô∏è NOT recommended <6 years'};if(am<144)return{st:'warn',lb:'Caution',tx:'5 mL q6-8h'};return{st:'ok',lb:'‚úì',tx:'10 mL q6-8h'};}
if(m==='dxm'){if(am<72)return{st:'bad',lb:'<6y',tx:'‚ö†Ô∏è NOT recommended <6 years'};if(am<144)return{st:'warn',lb:'Caution',tx:'5-10 mL q6-8h'};return{st:'ok',lb:'‚úì',tx:'10-20 mL q6-8h'};}
if(m==='ond'){if(w<8)return{st:'warn',lb:'Caution',tx:'0.15 mg/kg'};if(w<=15)return{st:'ok',lb:'‚úì',tx:'2 mg'};if(w<=30)return{st:'ok',lb:'‚úì',tx:'4 mg'};return{st:'ok',lb:'‚úì',tx:'8 mg'};}
if(m==='lac'){if(am<36)return{st:'warn',lb:'Ref',tx:'2.5-5 mL daily'};if(am<72)return{st:'warn',lb:'Ref',tx:'5-10 mL daily'};return{st:'warn',lb:'Ref',tx:'10-15 mL daily'};}
if(m==='dom'){const mgkg=rnd(0.25*w);if(am<144)return{st:'warn',lb:'‚ö†Ô∏è Caution',tx:`<b>If essential:</b> ${mgkg} mg (250 mcg/kg) TID<br>‚ö†Ô∏è NOT for routine N/V in <12y`};if(w<35)return{st:'warn',lb:'<35kg',tx:`${mgkg} mg TID - use lowest dose`};return{st:'warn',lb:'‚ö†Ô∏è',tx:'10 mg TID (MAX 1 WEEK)'};}
if(m==='hyo'){if(am<144)return{st:'ok',lb:'‚úì',tx:'5-10 mg TID'};return{st:'ok',lb:'‚úì',tx:'10-20 mg TID'};}
if(m==='amx'){const s=Math.min(rnd(45*w/3),500),h=Math.min(rnd(90*w/3),1000);return{st:'ok',lb:'‚úì',tx:`<b>Standard:</b> ${s} mg q8h<br><b>High:</b> ${h} mg q8h`};}
if(m==='aug'){const s=Math.min(rnd(40*w/3),500),h=Math.min(rnd(90*w/3),875);return{st:'ok',lb:'‚úì',tx:`<b>Standard:</b> ${s} mg q8h<br><b>High:</b> ${h} mg q8h`};}
if(m==='azi'){return{st:'ok',lb:'‚úì',tx:`${rnd(Math.min(10*w,500))} mg daily x3d`};}
if(m==='cef'){return{st:'ok',lb:'‚úì',tx:`${rnd(Math.min(15*w,500))} mg q12h`};}
if(m==='tmp'){return{st:'ok',lb:'‚úì',tx:`${rnd(Math.min(4*w,160))} mg TMP q12h`};}
if(m==='met'){const g=rnd(Math.min(7.5*w,250)),a=rnd(Math.min(10*w,500));return{st:'ok',lb:'‚úì',tx:`<b>Giardia:</b> ${g} mg q8h<br><b>Anaerobic:</b> ${a} mg q8h`};}
if(m==='para'){const lo=rnd(10*w),hi=rnd(15*w);return{st:'ok',lb:'‚úì',tx:`${lo}-${hi} mg/dose`};}
if(m==='paras'){const lo=10*w,hi=15*w;const str=med.nm.match(/(\d+)\s*mg/);const mg=str?parseInt(str[1]):125;const nLo=Math.round(lo/mg*10)/10,nHi=Math.round(hi/mg*10)/10;const recLo=Math.max(1,Math.round(nLo)),recHi=Math.max(1,Math.round(nHi));const dose=recLo===recHi?`${recLo} supp (${recLo*mg} mg)`:`${recLo}‚Äì${recHi} supp (${recLo*mg}‚Äì${recHi*mg} mg)`;return{st:'ok',lb:'‚úì',tx:dose};}
if(m==='ibu'){const lo=rnd(5*w),hi=rnd(10*w);return{st:'ok',lb:'‚úì',tx:`${lo}-${hi} mg/dose`};}
if(m==='dic'){const lo=0.5*w,hi=w;const mg=12.5;const nLo=Math.max(1,Math.round(lo/mg)),nHi=Math.max(1,Math.round(hi/mg));const maxDay=Math.floor(3*w/mg);const dose=nLo===nHi?`${nLo} supp (${rnd(nLo*mg)} mg)`:`${nLo}‚Äì${nHi} supp (${rnd(nLo*mg)}‚Äì${rnd(nHi*mg)} mg)`;return{st:'warn',lb:'‚ö†Ô∏è',tx:`${dose} BID-TID<br><b>Max ${maxDay} supp/day (3mg/kg/day)</b> ‚Ä¢ MAX 3 days`};}
if(m==='vitd')return{st:'ok',lb:'‚úì',tx:'<b>Prevention:</b> 4 drops (400 IU) daily'};
if(m==='fe'){const t=rnd(4.5*w),p=rnd(1.5*w);return{st:'ok',lb:'‚úì',tx:`<b>Treatment:</b> ${t} mg/day<br><b>Prevention:</b> ${p} mg/day`};}
return{st:'warn',lb:'Ref',tx:med.note||'See notes'};
}
function getMl(tx,c){if(!c||!tx)return'';const cl=tx.replace(/<[^>]*>/g,'');const mt=cl.match(/(\d+\.?\d*)\s*[-‚Äì]?\s*(\d+\.?\d*)?\s*mg/);if(!mt)return'';const lo=parseFloat(mt[1]),hi=mt[2]?parseFloat(mt[2]):lo;const mlo=rndMl(lo/c.c),mhi=rndMl(hi/c.c);return mlo===mhi?`${mlo} mL`:`${mlo}-${mhi} mL`;}
function updG(){
const y=+($('#ageY').value||0),mo=+($('#ageM').value||0),w=+($('#wt').value||0),h=+($('#ht').value||0),s=$('#sex').value,am=y*12+mo;
const sb=$('#sumBox');sb.textContent=`${y}y ${mo}m (${am} months) ‚Ä¢ ${w} kg${h?' ‚Ä¢ '+h+' cm':''}`;sb.className='sum'+(s?' '+s:'');
$('#sex').className=s||'';
const aD=$('#gAlert'),sD=$('#gSum');
if(!s||!w){aD.innerHTML='';sD.innerHTML='';return;}
const g=chkG(am,w,h,s);if(!g){aD.innerHTML='';sD.innerHTML='';return;}
let ah='';g.alerts.forEach(a=>{const cl=a.t==='bad'?'alert-box':a.t==='warn'?'warn-box':'info-box';const ic=s==='male'?'üë¶':'üëß';ah+=`<div class="${cl}"><span style="font-size:20px">${ic}</span><div><b>Saudi Growth:</b> ${a.m}</div></div>`;});
aD.innerHTML=ah;
let pts=[];if(g.wt)pts.push(`Wt: <b>${g.wt.p} %ile</b>`);if(g.ht)pts.push(`Ht: <b>${g.ht.p} %ile</b>`);if(g.bmi&&g.bmi.p)pts.push(`BMI: <b>${g.bmi.v}</b> (${g.bmi.p} %ile${g.bmi.st&&g.bmi.st!=='Normal'&&g.bmi.st!=='‚Äî'?' ‚Äì '+g.bmi.st:''})`);
sD.innerHTML=pts.length?`<div class="growth-box"><b>${s==='male'?'üë¶':'üëß'} Growth (Saudi):</b> ${pts.join(' ‚Ä¢ ')}</div>`:'';
}
function render(){
updG();
const y=+($('#ageY').value||0),mo=+($('#ageM').value||0),w=+($('#wt').value||0),am=y*12+mo;
const q=($('#srcBox').value||'').toLowerCase();
const box=$('#catBox');box.innerHTML='';
CATS.forEach(cat=>{
let ms=MEDS.filter(m=>m.cat===cat);
if(q)ms=ms.filter(m=>[m.nm,m.sn,m.ind||'',m.note||''].join(' ').toLowerCase().includes(q));
if(!ms.length)return;
const ex=expC.includes(cat);
const sec=document.createElement('div');sec.className='cat';
const hdr=document.createElement('div');hdr.className='cat-hdr'+(ex?' exp':'');
hdr.innerHTML=`<div class="cat-ttl"><div class="cat-ico">${ICOS[cat]||'üíä'}</div><span>${cat}</span><span class="cat-cnt">${ms.length}</span></div><span class="cat-arr">‚ñº</span>`;
hdr.onclick=()=>{const i=expC.indexOf(cat);if(i>-1)expC.splice(i,1);else expC.push(cat);localStorage.setItem('expC',JSON.stringify(expC));render();};
const body=document.createElement('div');body.className='cat-body'+(ex?' exp':'');
ms.forEach(med=>{
const res=calc(med,am,w);
const cn=med.conc?.[0];
const ml=getMl(res.tx,cn);
const isFav=favs.includes(med.id);
const ws=med.was?'<span class="badge b-was">Wasfaty</span>':'';
const card=document.createElement('div');card.className='med';
card.innerHTML=`
<div class="med-c">
<div class="med-hdr"><div class="med-nm">${med.sn||med.nm}</div><div style="display:flex;gap:6px;align-items:center;flex-wrap:wrap">${bg(res.st,res.lb)}${ws}<span class="fav" data-id="${med.id}">${isFav?'‚≠ê':'‚òÜ'}</span></div></div>
<div class="dose-c">${res.tx}</div>
${ml?`<div class="ml-c">üìè ${ml}</div>`:''}
<div class="freq-c">${med.frq||''}</div>
<div class="hint">Tap for details ‚ñº</div>
</div>
<div class="med-e">
<div class="med-nmf">${med.nm}</div>
<div style="display:flex;gap:6px;align-items:center;margin-bottom:12px;flex-wrap:wrap">${bg(res.st,res.lb)}${ws}<span class="fav" data-id="${med.id}">${isFav?'‚≠ê':'‚òÜ'}</span></div>
<div class="dose-e">${res.tx}</div>
${ml?`<div class="ml-e">üìè ${ml}</div>`:''}
<div class="freq-e">${med.frq||''}</div>
${med.tips?`<div class="info-box" style="margin-top:12px"><b style="color:#e3f2ff">üí°</b> ${med.tips}</div>`:''}
<div class="det"><div class="det-h"><span>üìã Indication & CI</span><span class="det-ico">‚ñº</span></div><div class="det-b"><div class="det-in"><div class="note"><b>Indication:</b><br>${med.ind||'‚Äî'}<br><br><b>Contraindications:</b><br>${med.ci||'‚Äî'}</div></div></div></div>
${med.note?`<div class="det"><div class="det-h"><span>üìù Dosing Notes</span><span class="det-ico">‚ñº</span></div><div class="det-b"><div class="det-in"><div class="note">${med.note}</div></div></div></div>`:''}
${med.se?`<div class="det"><div class="det-h"><span>‚ö†Ô∏è Side Effects</span><span class="det-ico">‚ñº</span></div><div class="det-b"><div class="det-in"><div class="note">${med.se}</div></div></div></div>`:''}
<button class="btn coll">‚ñ≤ Collapse</button>
</div>`;
card.addEventListener('click',e=>{if(e.target.closest('.fav')||e.target.closest('.coll')||e.target.closest('.det-h'))return;if(!card.classList.contains('exp'))card.classList.add('exp');});
card.querySelector('.coll')?.addEventListener('click',e=>{e.stopPropagation();card.classList.remove('exp');});
card.querySelectorAll('.fav').forEach(b=>{b.addEventListener('click',e=>{e.stopPropagation();const id=b.dataset.id;const i=favs.indexOf(id);if(i>-1)favs.splice(i,1);else favs.push(id);localStorage.setItem('favs',JSON.stringify(favs));render();});});
card.querySelectorAll('.det-h').forEach(dh=>{dh.addEventListener('click',e=>{e.stopPropagation();const db=dh.nextElementSibling;dh.classList.toggle('open');db.classList.toggle('open');});});
body.appendChild(card);
});
sec.appendChild(hdr);sec.appendChild(body);box.appendChild(sec);
});
}
function $(s){return document.querySelector(s);}
$('#ageY').addEventListener('input',render);
$('#ageM').addEventListener('input',render);
$('#wt').addEventListener('input',render);
$('#ht').addEventListener('input',render);
$('#sex').addEventListener('change',render);
$('#srcBox').addEventListener('input',render);
$('#histBtn').addEventListener('click',()=>{$('#histModal').classList.add('active');$('#histList').innerHTML=hist.length?hist.map(h=>`<div class="hist"><b>${h.med}</b>: ${h.dose} (${h.wt}kg)</div>`).join(''):'<p>No history yet</p>';});
$('#histX').addEventListener('click',()=>$('#histModal').classList.remove('active'));
$('#histClr').addEventListener('click',()=>{hist=[];localStorage.setItem('hist','[]');$('#histList').innerHTML='<p>Cleared</p>';});
$('#favBtn').addEventListener('click',()=>{$('#favModal').classList.add('active');const fm=MEDS.filter(m=>favs.includes(m.id));$('#favList').innerHTML=fm.length?fm.map(m=>`<div class="hist" style="cursor:pointer" onclick="$('#srcBox').value='${m.sn}';$('#favX').click();render();"><b>${m.sn}</b> - ${m.cat}</div>`).join(''):'<p>No favorites. Tap ‚òÜ to add.</p>';});
$('#favX').addEventListener('click',()=>$('#favModal').classList.remove('active'));
document.querySelectorAll('.modal').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('active');}));
render();
</script>
<script>
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').then(()=>console.log('SW registered')).catch(e=>console.log('SW error',e));
}
</script>
</body>
</html>
